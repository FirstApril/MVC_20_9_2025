<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, sans-serif;
      margin: 20px;
      background: #f4f6f9;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 20px;
      max-width: 600px;
      margin: 20px auto;
      text-align: center;
    }
    .stats p {
      font-size: 18px;
      margin: 12px 0;
    }
    .success {
      color: green;
      font-weight: bold;
    }
    .failed {
      color: red;
      font-weight: bold;
    }
    a.back {
      display: inline-block;
      margin-top: 20px;
      text-decoration: none;
      padding: 6px 12px;
      background: #2196f3;
      color: #fff;
      border-radius: 6px;
      font-size: 14px;
    }
    a.back:hover {
      background: #0b7dda;
    }
  </style>
</head>
<body>
  <h1>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</h1>
  <div id="statsView" class="card">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
  <a href="index.html" class="back">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏ß‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</a>

  <script>
    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    async function loadData() {
      const res = await fetch("data/db.json");
      return await res.json();
    }

    // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
    function renderStats(pledges) {
      const success = pledges.filter(p => p.status === "success").length;
      const failed = pledges.filter(p => p.status === "failed").length;
      const totalAmount = pledges
        .filter(p => p.status === "success")
        .reduce((sum, p) => sum + p.amount, 0);

      document.getElementById("statsView").innerHTML = `
        <div class="stats">
          <p class="success">‚úÖ ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${success} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
          <p class="failed">‚ùå ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ñ‡∏π‡∏Å‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò: ${failed} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
          <p><strong>üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:</strong> ${totalAmount} ‡∏ö‡∏≤‡∏ó</p>
        </div>
      `;
    }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    (async () => {
      const data = await loadData();
      renderStats(data.pledges);
    })();
  </script>
</body>
</html>
